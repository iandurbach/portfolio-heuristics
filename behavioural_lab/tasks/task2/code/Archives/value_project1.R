#Work out overallvalue of selected projects, value and cost change resulting from new entrants

value_proj1=function(numbers){


project<-numbers
n1<-length(project)
var.names<-c('Project1', 'Project2', 'Project3','Project4','Project5')
#var.names<-c('p1', 'p2', 'p3','p4','p5','p6','p7','p8','p9','p10')
n<-length(var.names)
maxWeight<-7
warning<-c("")

SameElements <- function (a,b){
  l <- Map(table,list(a, b)) # Compute frequencies - returns ordered table
  Reduce(identical,l) # Check if frequencies are the same for all input vectors
}


pval<-matrix(c(1,1,2,2,5),ncol=n,nrow=1)
#pval<-matrix(c(30,50,140,40,200,170,60,150,50,100),ncol=n,nrow=1)
wval<-matrix(c(1,2,3,4,2),ncol=n,nrow=1)
#wval<-matrix(c(4,40,40,5,150,60,30,30,30,70),ncol=n,nrow=1)


#setwd('C:/Users/DKantu01/Documents/PortfolioExperiment')
C<-read.csv(file="interactions1.csv",header=FALSE)
#C<-read.csv(file="interactions2.csv",header=FALSE)


C1<-data.frame(C)


CI<-array(0,dim=c(n,n)) #Interactions between selected projects and others

for (i in project){
CI[,i]<-C1[,i]
}

#interact<-apply(CI,1,sum)
int<-0
interact<-array(0,dim=c(n))

#values of selected solution
ip<-0 #interaction sum for selected projects
vp<-0 
wp<-0 

for (i in project){

vp<-vp+pval[i]
wp<-wp+wval[i]
}



#for (i in project){
#for (j in project){
#if (j>i){ip<-ip+CI[i,j]}
#}
#}

for (i in project){
  
ip1<-0
int<-0
int<-ifelse(SameElements(c(1, 2), project),3,0)
ip1<-ip1+int
int<-ifelse(SameElements(c(1, 3), project),3,0)
ip1<-ip1+int 
int<-ifelse(SameElements(c(1, 2, 3), project),3,0)
ip1<-ip1+int
int<-ifelse(SameElements(c(2, 3, 4), project),3,0)
ip1<-ip1+int
interact[i]<-ip1
  
  
}

int<-0
int<-ifelse(SameElements(c(1, 2), project),3,0)
ip<-ip+int
int<-ifelse(SameElements(c(1, 3), project),3,0)
ip<-ip+int
int<-ifelse(SameElements(c(1, 2, 3), project),3,0)
ip<-ip+int 
int<-ifelse(SameElements(c(2, 3, 4), project),3,0)
ip<-ip+int

pOverall<-vp+ip # overall value for selected projects
wOverall<-wp # overall profit for selected projects
AvailableWeight<-maxWeight-wOverall


interact1<-interact
pval1<-pval
wval1<-wval

for (i in project){
interact[i]<-c(NA)
pval1[i]<-c(NA)
}

interact2<-as.vector(interact)
newval<-pOverall+pval+interact2
newweight<-wOverall+wval

for (i in project){
newweight[i]<-c(NA)
wval1[i]<-c(NA)
}

project1<-c(1:n)
project1<-project1 [! project1 %in% project]

pval2<-pval
wval2<-wval

#for (i in project1){
#if (i in project){interact1[i]}
#else {interact1[i]<-c(NA)}
#}

for (i in project1){
interact1[i]<-c(NA)
pval2[i]<-c(NA)
}

interact3<-as.vector(interact1)
newval1<-pOverall-pval-interact3
newweight1<-wOverall-wval

for (i in project1){
newweight1[i]<-c(NA)
wval2[i]<-c(NA)
}

table1<-rbind(newval,newweight,interact2,pval1,wval1)
table2<-rbind(newval1,newweight1,interact3,pval2,wval2)
#add column names and transpose

if(AvailableWeight<0){warning<-c("You have exceeded your Budget!")}
    
  return(warning)
  
}











